<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>🎲 행운테스트</title>
  <style>
    body {
      background-color: #fff8f0;
      font-family: 'Nanum Gothic', 'Arial', sans-serif;
      text-align: center;
      padding: 40px;
      line-height: 1.6;
      color: #333;
    }
    input, button {
      font-size: 16px;
      padding: 8px;
      margin: 6px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      cursor: pointer;
      background-color: #f39c12;
      border: none;
      color: white;
      font-weight: bold;
    }
    button:hover {
      background-color: #d67e00;
    }
    #gameArea {
      margin-top: 30px;
    }
    #message {
      margin-top: 20px;
      font-size: 22px;
      font-weight: 600;
    }
    #poem {
      margin-top: 25px;
      font-size: 20px;
      white-space: pre-line;
      font-style: italic;
      color: #555;
      border-left: 3px solid #f39c12;
      padding-left: 15px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      min-height: 180px;
    }
  </style>
</head>
<body>
  <h1>🔢 숫자 맞추기 게임 + 3연 9행 운세 시</h1>

  <label for="birthInput">생년월일 입력:</label><br />
  <input type="date" id="birthInput" /><br />

  <label for="favNumberInput">좋아하는 숫자 입력 (1~99):</label><br />
  <input type="number" id="favNumberInput" min="1" max="99" /><br />

  <button onclick="startGame()">게임 시작</button>

  <div id="gameArea" style="display:none;">
    <p>1부터 10까지 숫자를 맞춰보세요!</p>
    <input type="number" id="guessInput" min="1" max="10" placeholder="숫자 입력" />
    <button onclick="checkGuess()">제출</button>
    <div id="message"></div>
    <div id="poem"></div>
  </div>

  <script>
    let secretNumber = null;
    let attempts = 0;

    // 생년월일과 좋아하는 숫자를 기반으로 결정적 랜덤 숫자 생성 (1~10)
    function generateSeededNumber(birth, favNum) {
      const combinedStr = birth.replace(/-/g, "") + favNum;
      let hash = 0;
      for (let i = 0; i < combinedStr.length; i++) {
        hash = (hash << 5) - hash + combinedStr.charCodeAt(i);
        hash |= 0; // 32bit int 변환
      }
      return Math.abs(hash) % 10 + 1;
    }

    // 5가지 구간별 3연 9행 운세 시
    const poems = {
      "1": [ // 1회 시도
        `오늘은 빛나는 햇살 아래  
모든 길이 환하게 열리고  
뜻밖의 기쁨이 다가오네  

자신감 가득한 발걸음에  
행운이 함께 춤을 추며  
새로운 시작을 노래하네  

가슴 속 불꽃 활활 타올라  
끝없는 가능성 펼쳐지니  
오늘 하루 빛나리라`
      ],
      "2-3": [ // 2~3회 시도
        `서서히 다가오는 바람결  
기회의 씨앗 땅에 뿌려지고  
작은 성취 꽃 피어나네  

꾸준한 노력이 빛을 내고  
희망의 길이 펼쳐지며  
마음은 점점 단단해져  

작은 걸음 모여 큰 걸음  
내일을 향한 발자국소리  
희망 가득 노래하리라`
      ],
      "4-5": [ // 4~5회 시도
        `잠시 머문 바람은 차갑고  
어려움의 그림자 드리우지만  
참는 마음은 꽃이 되네  

견디며 흘린 땀방울 속  
성장의 열매 맺어지니  
포기 않는 마음 빛나리라  

고단한 길 끝에 피는 꽃  
기다림은 결실을 부르고  
새로운 빛이 다가오리`
      ],
      "6-8": [ // 6~8회 시도
        `복잡한 세상 소용돌이 속  
혼란스런 마음 어지러워도  
차분히 가라앉히소서  

마음의 바다 잔잔해지면  
흐려진 길도 환히 보이고  
해답이 점차 찾아오리  

깊은 숨 고르며 나아가면  
어둠 뒤 빛이 반짝이니  
평화의 길 열리리라`
      ],
      "9+": [ // 9회 이상 시도
        `어두운 밤 지나 새벽 오듯  
힘든 시간도 끝나가고  
희망의 빛이 다가오네  

포기하지 않는 그대의 마음  
견딤 속에 행운이 깃들고  
끝까지 최선을 다하리  

길 끝에서 피어나는 꽃  
새로운 내일 기다리니  
용기 있게 걸어가소서`
      ]
    };

    // 게임 시작 함수
    function startGame() {
      const birth = document.getElementById("birthInput").value;
      const favNum = parseInt(document.getElementById("favNumberInput").value);

      if (!birth) {
        alert("생년월일을 입력해주세요!");
        return;
      }
      if (isNaN(favNum) || favNum < 1 || favNum > 99) {
        alert("좋아하는 숫자를 1에서 99 사이로 입력해주세요!");
        return;
      }

      secretNumber = generateSeededNumber(birth, favNum);
      attempts = 0;

      document.getElementById("gameArea").style.display = "block";
      document.getElementById("message").innerText = "";
      document.getElementById("poem").innerText = "";
      document.getElementById("guessInput").value = "";
      document.getElementById("guessInput").focus();

      console.log("비밀 숫자 (디버그):", secretNumber);
    }

    // 정답 체크 및 운세 시 출력
    function checkGuess() {
      const guess = parseInt(document.getElementById("guessInput").value);
      const messageDiv = document.getElementById("message");
      const poemDiv = document.getElementById("poem");

      poemDiv.innerText = "";

      if (secretNumber === null) {
        alert("먼저 게임을 시작해주세요!");
        return;
      }
      if (isNaN(guess) || guess < 1 || guess > 10) {
        alert("1부터 10까지 숫자를 입력해주세요!");
        return;
      }

      attempts++;

      if (guess === secretNumber) {
        messageDiv.innerText = `🎉 축하합니다! ${attempts}번 만에 맞췄어요!`;

        let key = "";
        if (attempts === 1) key = "1";
        else if (attempts <= 3) key = "2-3";
        else if (attempts <= 5) key = "4-5";
        else if (attempts <= 8) key = "6-8";
        else key = "9+";

        const poemList = poems[key];
        const selectedPoem = poemList[Math.floor(Math.random() * poemList.length)];

        poemDiv.innerText = selectedPoem;

      } else if (guess < secretNumber) {
        messageDiv.innerText = `⬆️ 업! 더 큰 숫자입니다. (시도: ${attempts}회)`;
      } else {
        messageDiv.innerText = `⬇️ 다운! 더 작은 숫자입니다. (시도: ${attempts}회)`;
      }
    }
  </script>
</body>
</html>
